// Generated by CoffeeScript 1.3.3
(function() {

  $(function() {
    $('#datepicker').datepicker();
    $('#datepicker').datepicker('option', 'dateFormat', 'yy/mm/dd');
    $('#category').change(function() {
      var selected;
      selected = $('#category').val();
      switch (selected) {
        case 'Fuel':
          return $('#fuel-details').show('slow');
      }
    });
    $('#country').change(function() {
      var selected;
      selected = $('#country').val();
      switch (selected) {
        case 'Canada':
          $('#state').html('<option value=\'State\'>State</option>\n<option value=\'AB\'>AB</option>\n<option value=\'BC\'>BC</option>\n<option value=\'MB\'>MB</option>\n<option value=\'NB\'>NB</option>\n<option value=\'NL\'>NL</option>\n<option value=\'NS\'>NS</option>\n<option value=\'NT\'>NT</option>\n<option value=\'NU\'>NU</option>\n<option value=\'ON\'>ON</option>\n<option value=\'PE\'>PE</option>\n<option value=\'QC\'>QC</option>\n<option value=\'SK\'>SK</option>\n<option value=\'YT\'>YT</option>');
          return $('#units').html("<option value='L'>L</option>");
        case 'USA':
          $('#state').html('<option value=\'State\'>State</option>\n<option value=\'WA\'>WA</option>\n<option value=\'NY\'>NY</option>');
          return $('#units').html("<option value='Gal'>Gal</option>");
      }
    });
    $('#submit-expense').click(function() {
      var expense;
      expense = {
        category: $('#category').val().toLowerCase(),
        date: new Date(Date.parse($('#datepicker').val().replace(/\//g, ' '))),
        amount: $('#amount').val(),
        currency: $('#currency').val()
      };
      if (expense.category === 'fuel') {
        expense['country'] = $('#country').val();
        expense['state'] = $('#state').val();
        expense['quantity'] = $('#quantity').val();
        expense['units'] = $('#units').val();
      }
      return now.submit_expense(expense);
    });
    $('#submit-stop').click(function() {
      var stop;
      stop = {
        type: 'stop',
        date: new Date(Date.parse($('#datepicker').val().replace(/\//g, ' '))),
        country: $('#country').val(),
        state: $('#state').val(),
        address: $('#address').val(),
        postal_code: $('#postal-code').val()
      };
      return now.submit_stop(stop);
    });
    now.update_expenses = function(expenses) {
      var date, expense, row, rows, _i, _len;
      expenses = expenses.reverse();
      rows = '';
      for (_i = 0, _len = expenses.length; _i < _len; _i++) {
        expense = expenses[_i];
        date = new Date(expense.value.date).toLocaleDateString();
        row = "<tr>\n  <td>" + date + "</td>\n  <td>" + expense.value.category + "</td>\n  <td>" + expense.value.amount + "</td>\n  <td>" + expense.value.currency + "</td>\n</tr>";
        rows += row;
      }
      return $('tbody').html(rows);
    };
    return now.update_stops = function(stops) {
      var date, row, rows, stop, _i, _len;
      stops = stops.reverse();
      rows = '';
      for (_i = 0, _len = stops.length; _i < _len; _i++) {
        stop = stops[_i];
        date = new Date(stop.value.date).toLocaleDateString();
        row = "<tr>\n  <td>" + date + "</td>\n  <td>" + stop.value.country + "</td>\n  <td>" + stop.value.state + "</td>\n  <td>" + stop.value.address + "</td>\n  <td>" + stop.value.postal_code + "</td>\n</tr>";
        rows += row;
      }
      return $('tbody').html(rows);
    };
  });

}).call(this);
